@model ContentModel

@{
    ViewData["Title"] = "Generate Json";

    var selectedImageList = Model.MyFiles.Where(x => x.IsSelected == true).ToList();
    var unSelectedImageList = Model.MyFiles.Where(x => x.IsSelected == false).ToList();

}

<script src="~/lib/jquery/dist/jquery.js"></script>

<style>

    .lighter {
        filter: brightness(150%);
        opacity: 1;
    }

    abody {
        background-color: black;
        opacity: 0.7;
        color: darkgray;
    }

    .box {
        width: 100px;
        height: 100px;
        margin: 20px;
        border: 0px solid #ff6703;
        padding: 5px;
    }

    #dragtarget img {
        margin-top: 10px;
        margin-bottom: 10px;
    }

    .selectedbox {
        background-color: gainsboro;
        opacity: 0.4;
        border: 5px solid #ff6703;
    }

    .jdisplay {
        padding: 10px;
    }

    div.col-12.d-flex {
        min-height: 100px;
    }

    #JsonLink {
        overflow-wrap: break-word;
        word-wrap: break-word;
        hyphens: auto;
    }

    .jdisplay ul {
        list-style-type: none;
    }
</style>

<script>

    function fileSelected() {

        var getIds = [];
        $("#dragtarget img").each(function () {
            getIds.push(this.id);
        });

        return btoa(getIds.join());
    }


    function generateJson() {
        location.href = '@Url.Action("AddToSelectionList", "Home")?selectedFiles=' + fileSelected();
    };


    $(document).ready(function () {
        $("img.border-danger").click(function () {

            if ($(this).parent().attr("id") != "dragtarget") {
                $(this).hide().appendTo("#dragtarget").show('slow');
            }
            else {
                $(this).hide().appendTo("#dragsource").show('slow');
            }

            generateJson();
        });

        $("img").hover(function () {
            $(this).toggleClass("lighter");
        });


    });
</script>

<div class="container">
    <div class="row">
        <div class="col-12">
            Your selection
        </div>
    </div>
    <div class="row">
        <div class="col-12 d-flex flex-row border flex-wrap" id="dragtarget">
            @foreach (var file in selectedImageList)
                {
                    <img class="box rounded border border-warning" src="@Url.Content(file.Path)" alt="@file.Name" id="@file.Name">
                    <ul>
                        <li>title:  @file.Title</li>
                        <li>lengthKb: @file.LengthKb</li>
                        <li>lengthMb: @file.LengthMb</li>
                        <li>url: @file.Url </li>
                    </ul>
                }
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            Your images
        </div>
    </div>
    <div class="row">
        <div class="col-12 d-flex flex-row border flex-wrap" id="dragsource">
            @foreach (var file in unSelectedImageList)
            {
                <img class="box rounded border border-danger" src="@Url.Content(file.Path)" alt="@file.Name" id="@file.Name">
            }
        </div>
    </div>
    <br />
    <br />
    <p id="JsonLinkLabel"></p>
    <div class="row border jdisplay" id="JsonLink">
        @Model.ApiGetUrl
    </div>
    <br />
    <br />
    <br />
    <br />
    <p id="JsonPreviewLabel"></p>
    <div class="row border jdisplay" id="JsonPreview">
    </div>
    @{ foreach (var file in selectedImageList)
        {
            <p>@file.Title</p>
            <ul>
                    <strong>myJson</strong>
                    <li>
                        <ul>
                            <li>title:  @file.Title</li>
                            <li>lengthKb: @file.LengthKb</li>
                            <li>lengthMb: @file.LengthMb</li>
                            <li>url: @file.Url </li>
                        </ul>
                    </li>
                    <br />
                </ul>
        }
    }
</div>
